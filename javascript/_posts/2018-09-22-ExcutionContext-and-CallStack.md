---
layout: post
title: 실행 컨텍스트(Excution Context) 와 호출스택 (Call Stack)
---
첫 포스팅은 실행 컨텍스트를 주제로 작성하려고 합니다. 사실 첫 포스팅 주제로 클로저를 하려고했는데 실행 컨텍스트와 스코프체인에 대한 설명이 필요하여 급히 첫번째 포스팅 주제를 바꿨습니다.

# 실행 컨텍스트(Execution Context)
EcmaScript스펙에 따르면 실행 컨텍스트는 실행가능한 코드를 형상화 하고 구분하는 추상적인 개념이라고 정의됩니다. 쉽게 코드를 실행하기 위한 환경이라고 생각하시면 됩니다.

## 물리적 구조 
물리적 구조는 다음과 같습니다.

- 변수객체 (Variable Object) 
- 스코프 체인 (Scope Chain) 
- this

## 변수객체 (Variable Object)
변수객체는 실행에 필요한 정보를 담은 객체입니다. 엔진에 의해 참조되며 코드로는 접근 할 수가 없습니다.
전역 컨텍스트는 전역 객체를 가리키며, 함수 컨텍스트는 활성 객체를 가리키는데 두객체의 차이점은 다음과 같습니다.

### 전역 객체
- 전역컨텍스트가 가리키는 변수객체
- 전역변수, 전역함수를 소유합니다.
- 코드 실행 최초에 생성되며 종료될때까지 유지됩니다.

### 활성 객체
- 함수컨텍스트가 가리키는 변수객체
- 내부 함수, 지역변수를 소유합니다.
- 함수 실행시 생성되며 함수가 종료될때까지 유지됩니다. (클로저가 생성되지 않을경우)
- 활성 객체는 매개변수와 인수의 정보를 가진 arguments객체를 가지고있다.


## 스코프 체인(Scope Chain)
스코프체인은 접근가능한 변수를 검색하는 메커니즘인데,
리스트 형태이며 가장 처음에는 현재 실행 활성객체를 차례대로 상위 함수의 활성객체를 담고 마지막에는 전역 객체를 담습니다.
또한 어휘적 환경에 따라 구성됩니다.

검색시 리스트에 담긴순서(앞쪽부터)대로 조회하며, 실패시 다음 리스트를 검색합니다. 리스트 전체에서 검색을 실패하면 referenceError가 발생합니다. 

함수의 감추어진 프로퍼티인 [[scope]]를통해 참조합니다.

## this
this가 가르키는값 함수 호출패턴에 의해 결정됩니다. 

## 생성과정

1. 컨텍스트 종류에따라 전역 또는 활성 객체 생성 
2. 스코프체인 생성 초기화 
3. 변수 선언, 초기화 - 변수객체에 변수를 등록하여 스코프에서 참조할수 있도록 합니다. 그 후 메모리를 할당하는데 이 때 변수는 undifined로 초기화 됩니다.
4. this값 결정
5. 함수 코드 실행 


# 호출스택 
자바스크립트는 하나의 호출스택만 가진 싱글스레드 언어입니다.
호출스택은 우리가 어디있는지기록하는 자료구조입니다. 이름그대로 LIFO(Last in first out) 구조입니다. 

함수를 실행하면 해당 컨텍스트가 호출스택 최상단에 들어가고 매개변수와 함께 제어를 해당 컨텍스트로 넘깁니다 .
함수 실행이 끝나면 해당 컨텍스트는 제거되며 직전의 컨텍스트로 반환값과 함께 제어를 반환합니다.

# Refrence

- https://poiemaweb.com/js-execution-context
- http://haviyj.tistory.com/10
- https://www.zerocho.com/category/JavaScript/post/5741d96d094da4986bc950a0
- https://joshua1988.github.io/web-development/javascript/javascript-basic-summary/#실행-컨텍스트를-이해하기-위한-자바스크립트-동작과정


